<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="NINAs Technical Guidebook for Local-Scale Ecosystem Accounting Projects">
<title>Bluegreen Factor (BGF) – Local Ecosystem accounts - a technical guidebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../data-collection/field-surveys/rshiny-carbonviewer.html" rel="next">
<link href="../../data-collection/field-surveys/qfield-bm.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../data-collection/data-collection.html">Data Collection</a></li><li class="breadcrumb-item"><a href="../../data-collection/field-surveys/qfield-bgf.html"><span class="chapter-title">Bluegreen Factor (BGF)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Local Ecosystem accounts - a technical guidebook</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/NINAnor/EAguide" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../project-management/project-management.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Project Management</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">QGIS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../qgis/qgis-installation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Install QGIS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../qgis/qfield-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">QField and QCloud setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../qgis/qgis-plugins.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">QGIS plugins</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../qgis/qgis-background-maps.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Background layers</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../data-collection/data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Collection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../data-collection/field-surveys/qfield-nin.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">NiN 2.0 Naturtype Mapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../data-collection/field-surveys/qfield-bm.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Biodiversity Metric 4.0</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../data-collection/field-surveys/qfield-bgf.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Bluegreen Factor (BGF)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../data-collection/field-surveys/rshiny-carbonviewer.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">CarbonViewer</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../data-analysis/data-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../data-publishing/data-publishing.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Data Publishing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/documentation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Documentation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">FAIR Data Management</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fair-data/fair-principles.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">FAIR Principles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fair-data/naming-convention.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Naming Convention</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../appendix/appendix-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Additional Notes</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#bgf-norms-and-calculation-methods" id="toc-bgf-norms-and-calculation-methods" class="nav-link active" data-scroll-target="#bgf-norms-and-calculation-methods">BGF Norms and calculation methods</a></li>
  <li>
<a href="#bgf-qgis-user-guide" id="toc-bgf-qgis-user-guide" class="nav-link" data-scroll-target="#bgf-qgis-user-guide">BGF-QGIS User Guide</a>
  <ul class="collapse">
<li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#map-the-project-area" id="toc-map-the-project-area" class="nav-link" data-scroll-target="#map-the-project-area">Map the Project Area</a></li>
  <li><a href="#map-blue-green-structures" id="toc-map-blue-green-structures" class="nav-link" data-scroll-target="#map-blue-green-structures">Map Blue-Green Structures</a></li>
  <li><a href="#total-bgf" id="toc-total-bgf" class="nav-link" data-scroll-target="#total-bgf">Calculate the total BGF score</a></li>
  <li><a href="#calculate-the-total-cost-for-blue-green-infrastructure" id="toc-calculate-the-total-cost-for-blue-green-infrastructure" class="nav-link" data-scroll-target="#calculate-the-total-cost-for-blue-green-infrastructure">Calculate the total cost for Blue-Green Infrastructure</a></li>
  <li><a href="#export-data" id="toc-export-data" class="nav-link" data-scroll-target="#export-data">Export Data</a></li>
  <li><a href="#common-errors" id="toc-common-errors" class="nav-link" data-scroll-target="#common-errors">Common errors</a></li>
  </ul>
</li>
  <li><a href="#nina-contacts" id="toc-nina-contacts" class="nav-link" data-scroll-target="#nina-contacts">NINA Contacts</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/NINAnor/EAguide/edit/main/data-collection/field-surveys/qfield-bgf.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p><small><em style="font-size: 0.75em;">Content on this page has been partially created using AI services from OpenAI and GitHub Copilot. All content is quality assured by NINA employees before publication.</em></small></p>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../data-collection/data-collection.html">Data Collection</a></li><li class="breadcrumb-item"><a href="../../data-collection/field-surveys/qfield-bgf.html"><span class="chapter-title">Bluegreen Factor (BGF)</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span class="chapter-title">Bluegreen Factor (BGF)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>The Bluegreen Factor (BGF) is a norm promoting blue-green development in municipal building zones by assesses the quality of blue-green structures, which includes water bodies like lakes and rivers (<strong>blue</strong>) and natural areas such as parks and gardens (<strong>green</strong>). The BGF norm weights blue-green structures and measures. The sum of these weighted values, divided by the area of the plot, gives the BGF value for the project. Traditionally, this process was done by manually recording the area of each blue-green structure and the count of each measure in a spreadsheet. The BGF-QGIS app automates this task by allowing the user to map and digitize blue-green structure typologies and measures. The app calculates the area of each blue-green structure and counts the number of measures. The user can then choose a BGF norm or define a custom norm. The total BGF value for the project area is calculated and displayed in the app.</p>
<p><strong>Cost calculation of Blue-Green Infrastructure</strong></p>
<p>The BGF-QGIS app integrated a cost module which calculates the investment and maintenance cost per blue-green structure and measures as well as for the total project area.</p>
<p><em>Bart add more text here</em></p>
<section id="bgf-norms-and-calculation-methods" class="level2"><h2 class="anchored" data-anchor-id="bgf-norms-and-calculation-methods">BGF Norms and calculation methods</h2>
<p>The app supports the following norms:</p>
<ul>
<li>
<strong>BGF PBE 2023:</strong> <a href="https://www.oslo.kommune.no/plan-bygg-og-eiendom/planer-normer-og-veiledere/kommunale-normer/#toc-5">Norm for vegetasjon og vannhåndtering (blågrønn faktor)</a>
</li>
<li>
<strong>BGF Standard Norge 2020:</strong> <a href="https://online.standard.no/nb/ns-3845-2020">NS 3845:2020</a>
</li>
<li>
<strong>Custom user-defined norm</strong>: the user manually defines the weights for the different blue-green structures and measures inside the app.</li>
</ul>
<section id="differences-between-bgf-pbe-2023-and-sn-2020" class="level4"><h4 class="anchored" data-anchor-id="differences-between-bgf-pbe-2023-and-sn-2020">Differences between BGF PBE 2023 and SN 2020</h4>
<ul>
<li>
<strong>Green terrain:</strong>
<ul>
<li>
<strong>PBE 2023:</strong> Distinguishes between both new and existing vegetation and surface layer.</li>
<li>
<strong>SN 2020:</strong> Does not distuinguish between vegetation and surface layer. Existing vegetation is factored in as a additional weight.</li>
</ul>
</li>
<li>
<strong>Green Roofs:</strong>
<ul>
<li>
<strong>PBE 2023:</strong> Classifies green roofs by growing medium with specific growing ranges per class.</li>
<li>
<strong>SN 2020:</strong> Uses slightly different growing ranges and weights per class for green roofs.</li>
</ul>
</li>
<li>
<strong>Green Walls:</strong>
<ul>
<li>
<strong>PBE 2023:</strong> Distinguishes between vertical urban agriculture and climbing plants.</li>
<li>
<strong>SN 2020:</strong> Does not distinguish between vertical urban agriculture and climbing plants, and uses slightly different weights.</li>
</ul>
</li>
<li>
<strong>Surface Water</strong>:
<ul>
<li>No differences in the classification, but <strong>PBE 2023</strong> weights surface water higher than <strong>SN 2020</strong>.</li>
</ul>
</li>
<li>
<strong>Surface depsression:</strong>
<ul>
<li>
<strong>PBE 2023:</strong> Classifies surface depression but does not classify additional measures.</li>
<li>
<strong>SN 2020:</strong> Classifies surface depression and factores in the mainfunction: infiltration or reduction/delay of runoff.</li>
</ul>
</li>
<li>
<strong>Permeable and Impermeable surfaces:</strong>
<ul>
<li>
<strong>PBE 2023:</strong> Classifies permeable and impermeable surfaces and subclassifies permeable surfaces into: permeable green, semi-permeable gray and partially permeable gray surfaces.</li>
<li>
<strong>SN 2020:</strong> Classifies permeable and impermeable surfaces, but does not subclassify permeable surfaces.</li>
</ul>
</li>
</ul>
<p>A crosswalk between the two norms is provided in the BGF-QGIS app, and can be downloaded <a href="">here</a>.</p>
</section></section><section id="bgf-qgis-user-guide" class="level2"><h2 class="anchored" data-anchor-id="bgf-qgis-user-guide">BGF-QGIS User Guide</h2>
<section id="getting-started" class="level3"><h3 class="anchored" data-anchor-id="getting-started">Getting Started</h3>
<ol type="1">
<li><a href="../../qgis/qgis-installation.html">Install QGIS</a></li>
<li>
<a href="../../qgis/qgis-plugins.html">Install</a> and activate the plugins: <code>Plugins -&gt; Manage and Install Plugins</code>
<ul>
<li>Geometry Checker (core plugin)</li>
<li>Offline editing (core plugin)</li>
<li>Processing (core plugin)</li>
<li>Topology Checker (core plugin)</li>
<li>(OPTIONAL) QField Sync</li>
<li>(OPTIONAL) NIB-ortofoto-prosjekt</li>
</ul>
</li>
<li>Activate necessary toolbars: <code>View -&gt; Toolbars</code>
<ul>
<li>Project Toolbar</li>
<li>Map Navigation toolbar</li>
<li>Attributes Toolbar</li>
<li>Plugins toolbar</li>
<li>Selection Toolbar</li>
<li>Digitizing Toolbar</li>
<li>Snapping Toolbar</li>
<li>(OPTIONAL) Advanced digitizing toolbar</li>
<li>(OPTIONAL) Shape digitizing toolbar</li>
</ul>
</li>
<li>Activate necessary panels: <code>View -&gt; Panels</code>
<ul>
<li>Browser Panel</li>
<li>Layer Panel</li>
</ul>
</li>
<li>Download or clone the BGF-QGIS app from GitHub: <a href="https://github.com/ac-willeke/BGF-QGIS_3.x">BGF-QGIS_3.x</a>
</li>
</ol>
<p>You are all set up and can now open the BGF-QGIS project in QGIS!</p>
<section id="configure-the-project" class="level4"><h4 class="anchored" data-anchor-id="configure-the-project">Configure the Project</h4>
<p>Configure the <strong>project settings</strong>: <code>Project -&gt; Properties</code></p>
<ul>
<li>Set the project title: <code>-&gt; General</code>
</li>
<li>Set the project units: <code>-&gt; General</code>
<ul>
<li>Default: meters</li>
</ul>
</li>
<li>Set the title, author and abstract: <code>-&gt; Metadata</code>:</li>
<li>Set the project CRS to the desired coordinate reference system: <code>-&gt; CRS</code>
<ul>
<li>Default: EPSG:25832 (ETRS89 / UTM zone 32N)</li>
</ul>
</li>
</ul></section><section id="background-maps" class="level4"><h4 class="anchored" data-anchor-id="background-maps">Background Maps</h4>
<p>The BGF-QGIS app provides online <a href=".../qgis/qgis-background-maps.qmd">background maps</a> for the whole of Norway under the group “Online Grunnkart” in the QGIS Layer Panel. The user can also add additional WMS layers by selecting <code>Layer -&gt; Add Layer -&gt; Add WMS/WMTS Layer</code>.</p>
<p>It is recommended to download offline maps for the project area to ensure that the app works offline, and to make it easier to digitize blue-green structures by snapping to the background map.</p>
<p><strong>Download offline maps</strong>:</p>
<ul>
<li><code>Layer -&gt; Add Layer -&gt; Add Raster Layer/Add Vector Layer</code></li>
<li>It is recommended to download the following layers:
<ul>
<li>FKB bygning - bygning_omrade: <a href="https://kartkatalog.geonorge.no/metadata/fkb-bygning/8b4304ea-4fb0-479c-a24d-fa225e2c6e97">GeoNorge - FKB bygning</a>
</li>
<li>Matrikkelen Eiendomskart teig: <a href="https://kartkatalog.geonorge.no/metadata/matrikkelen-eiendomskart-teig/74340c24-1c8a-4454-b813-bfe498e80f16?search=teig">GeoNorge - Matrikkelen</a>
</li>
<li>Tree crown polygons for your municipality if available.
<ul>
<li><a href="maps-test.nina.no">Oslo Trekroner 2021</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="note">
<p><strong>Note</strong> that for offline use of the BGF-QGIS app. You must remove the online background maps (WMS-layers) from the QGIS project, otherwise your QGIS project is not able to work offline. Do this BEFORE going offline or into flightmode.</p>
</div>
</section><section id="snapping-options" class="level4"><h4 class="anchored" data-anchor-id="snapping-options">Snapping Options</h4>
<p>Configure <strong>snapping options</strong>: <code>Settings -&gt; Snapping Options</code></p>
<ul>
<li>Enable snapping options for the project.</li>
<li>Recommended snapping tolerance is 10 pixels.</li>
<li>Set the snapping mode to <code>Vertex</code> and <code>Segment</code>. This allows you to snap to the other BGF typology polygons, the offline background map layers and the project area boundary.</li>
<li>Enable the <code>Avoid intersection</code> option for the layer <code>BGF Typologi</code>. This prevents the creation of overlapping polygons and automatically cuts the new polygon along the boundary of the existing polygon.</li>
</ul>
<br><figure style="width: 100%; max-width: 650px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="bgf_qgis_snapping.PNG" alt="Recommended snapping options" style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Recommended snapping options.
</figcaption></figure><p>You can activate and deactivate snapping and tracing of objects by clicking on their icons or pressing the shortcut keys.</p>
<ul>
<li>Snapping icon: <code>manget</code> (Shortcut: <code>s</code>)</li>
<li>Tracing icon: <code>line and lightning bolt</code> (Shortcut: <code>t</code>)</li>
</ul>
<br><figure style="width: 100%; max-width: 300px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="bgf_qgis_icons.PNG" alt="Activating/deactivating snapping and tracing of objects." style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Activating/deactivating snapping and tracing of objects.
</figcaption></figure></section></section><section id="map-the-project-area" class="level3"><h3 class="anchored" data-anchor-id="map-the-project-area">Map the Project Area</h3>
<p>Map the project area, which is often a cadastral parcel or a building plot. It helps to add and enable a background map with the cadastral parcel boundaries (see <a href="#background-maps">Background Maps</a>).</p>
<ol type="1">
<li>Select the <code>Lokalitetsområde</code> layer in the QGIS Layer Panel.</li>
<li>Activate editing mode by clicking on the <code>Pencil</code> icon.</li>
<li>Activate <code>Enable tracing (t)</code>to easily follow the cadastral parcel boundary.</li>
<li>Click on the <code>Add Polygon Feature</code> icon and digitize the project area by tracing the cadastral parcel boundary. Finish by right-clicking or double-clicking.</li>
<li>Review the auto-filled fields in the pop-up window and click <code>OK</code>. To reopen the pop-up window, use the <code>Identify Features</code> button and click on the project area polygon. Then click on the <code>Open form</code> button.</li>
</ol>
<p>Advanced digitizing options <em>(e.g.&nbsp;splitting/merging of polygons)</em> are explained in the <a href="https://docs.qgis.org/3.34/en/docs/user_manual/working_with_vector/editing_geometry_attributes.html">QGIS User Guide</a>.</p>
<br><figure style="width: 100%; max-width: 650px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="digitize_project_area.PNG" alt="Digitize the project area (Lokalitetsområde)." style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Digitize the project area (Lokalitetsområde).
</figcaption></figure><p>It is recommended to digitize only one project area per QGIS project. If you have multiple project areas, you can create a new QGIS project for each project area using the template provided in the BGF-QGIS app.</p>
<div class="note">
<p><strong>Note</strong> that is important to save your edits regularly by clicking on the <code>Save Layer Edits</code> icon or using <code>Ctrl + S</code>. You can also save the project by clicking on <code>Project -&gt; Save</code> or using <code>Ctrl + S</code>.</p>
</div>
</section><section id="map-blue-green-structures" class="level3"><h3 class="anchored" data-anchor-id="map-blue-green-structures">Map Blue-Green Structures</h3>
<p>Map the blue-green structures within the project area. The BGF-QGIS app provides a predefined typology layer, <code>BGF typologier</code>, with the typologies listed in the table below. For a full cross-walk table showing both English and Norwegian typology names see <a href="bgf_typology_crosswalk.xlsx">BGF_typology_lookup</a>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 37%">
<col style="width: 35%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">BGF main typology</th>
<th style="text-align: left;">BGF subtypology (Norm: PBE 2023)</th>
<th style="text-align: left;">BGF subtypology (Norm: PBE 2020)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Green terrain</td>
<td style="text-align: left;">B1.1 - Green terrain: existing field and shrub layer &lt; 2m</td>
<td style="text-align: left;">A1, T2 - Green terrain: existing vegetation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green terrain</td>
<td style="text-align: left;">B1.2 - Green terrain: new field and shrub layer &lt; 2m</td>
<td style="text-align: left;">A1 - Green terrain</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Green terrain</td>
<td style="text-align: left;">B1.3 - Green terrain: existing ground layer</td>
<td style="text-align: left;">A1, T2 - Green terrain: existing vegetation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green terrain</td>
<td style="text-align: left;">B1.4 - Green terrain: new ground layer</td>
<td style="text-align: left;">A1 - Green terrain</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Green roofs</td>
<td style="text-align: left;">B2.1 - Green roof: growing medium ≥ 80 cm</td>
<td style="text-align: left;">A2.4 - Green roof: growing medium ≥ 60 cm</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green roofs</td>
<td style="text-align: left;">B2.2 - Green roof: growing medium 40-80 cm</td>
<td style="text-align: left;">A2.3 - Green roof: growing medium 20-60 cm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Green roofs</td>
<td style="text-align: left;">B2.3 - Green roof: growing medium 10-39 cm</td>
<td style="text-align: left;">A2.2 - Green roof: growing medium 3-20 cm</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green roofs</td>
<td style="text-align: left;">B2.4 - Green roof: growing medium 3-9 cm</td>
<td style="text-align: left;">A2.1 - Green roof: growing medium 0-3 cm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Green walls</td>
<td style="text-align: left;">B3.1 - Green wall: plant wall and vertical agriculture</td>
<td style="text-align: left;">T3 - Green wall</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green walls</td>
<td style="text-align: left;">B3.2 - Green wall: climbing plants</td>
<td style="text-align: left;">T3 - Green wall</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rain gardens, water features and wetlands</td>
<td style="text-align: left;">B4 - Rain garden, water bodies, and wetland</td>
<td style="text-align: left;">A3 - Water surface</td>
</tr>
<tr class="even">
<td style="text-align: left;">Terrain subsidence and wadi</td>
<td style="text-align: left;">B5 - Terrain depression</td>
<td style="text-align: left;">T1.1 - Terrain depression: infiltration</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Terrain subsidence and wadi</td>
<td style="text-align: left;">B5 - Terrain depression</td>
<td style="text-align: left;">T1.2 - Terrain depression: retention</td>
</tr>
<tr class="even">
<td style="text-align: left;">Partly permeable surface</td>
<td style="text-align: left;">B6.1 - Partially open surface: permeable green</td>
<td style="text-align: left;">A4 - Permeable surface</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Partly permeable surface</td>
<td style="text-align: left;">B6.2 - Partially open surface: semi-permeable gray</td>
<td style="text-align: left;">A4 - Permeable surface</td>
</tr>
<tr class="even">
<td style="text-align: left;">Partly permeable surface</td>
<td style="text-align: left;">B6.3 - Partially open surface: partially permeable gray</td>
<td style="text-align: left;">A4 - Permeable surface</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Impermeable surface</td>
<td style="text-align: left;">B7 - Impermeable surface</td>
<td style="text-align: left;">A5 - Impermeable surface</td>
</tr>
<tr class="even">
<td style="text-align: left;">Existing trees</td>
<td style="text-align: left;">C1.1 - Existing trees (XL): trunk circumference &gt; 200 cm</td>
<td style="text-align: left;">T5.3 - Existing trees (L): trunk circumference &gt; 90 cm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Existing trees</td>
<td style="text-align: left;">C1.2 - Existing trees (L): trunk circumference 90-200 cm</td>
<td style="text-align: left;">T5.3 - Existing trees (L): trunk circumference &gt; 90 cm</td>
</tr>
<tr class="even">
<td style="text-align: left;">Existing trees</td>
<td style="text-align: left;">C1.3 - Existing trees (S): trunk circumference &lt; 90 cm</td>
<td style="text-align: left;">T5.2 - Existing trees (L): trunk circumference &lt; 90 cm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">New trees</td>
<td style="text-align: left;">C2.1 - New trees (L): future height &gt; 10 m</td>
<td style="text-align: left;">T4.1 - New trees (L): future height &gt; 10 m</td>
</tr>
<tr class="even">
<td style="text-align: left;">New trees</td>
<td style="text-align: left;">C2.1 - New trees (S): future height &lt; 10 m</td>
<td style="text-align: left;">T4.1 - New trees (S): future height &lt; 10 m</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p><strong>Digitizing the blue-green structures</strong></p>
<ol type="1">
<li>Select the <code>BGF typologi</code> layer in the QGIS Layer Panel.</li>
<li>Activate editing mode by clicking on the <code>Pencil</code> icon.</li>
<li>Ensure that the in the Snapping options <code>Avoid overlay</code> is enabled for the BGF typology layer, so polygons are automatically cut along eachothers border.</li>
<li>Activate <code>Enable tracing (t)</code>to easily follow background layers such as buildings and treecrowns.</li>
<li>Click on the <code>Add Polygon Feature</code> icon to add a new typology polygon. Finish by right-clicking or double-clicking. A pop-up window opens to start editing the attributes.</li>
</ol>
<p><strong>Filling in the attributes</strong></p>
<ol type="1">
<li>Review the <code>admin</code> attributes and check that they are filled out correctly.
<ul>
<li>Check that the <code>ID - Lokalitetsområde</code> corresponds with the study area ID.</li>
<li>Check the <code>Kartlegger</code> (registrant) and <code>Kartleggingsdato</code> (date).</li>
</ul>
</li>
</ol>
<figure style="width: 100%; max-width: 650px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="bgf_admin_fields.PNG" alt="Administrative and Area attributes." style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Check the administrative and area atrributes.
</figcaption></figure><ol start="2" type="1">
<li>Select the BGF Norm you like to use for mapping: <code>PBE 2023</code> or <code>SN 2020</code>
<ul>
<li>the url to the selected norm will apear for additional info.</li>
<li>additional tabs become visible to start classifing the typology.</li>
</ul>
</li>
</ol>
<figure style="width: 100%; max-width: 650px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="bgf_norm_field.PNG" alt="Fill out the BGF Norm." style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Fill out the BGF Norm.
</figcaption></figure><ol start="3" type="1">
<li>Classify the BGF typology
<ul>
<li>select the main typology in the tab <code>BGF hovedtypologi</code>
</li>
<li>depending on which Norm you have selected, you can select the sub typology in either the <code>PBE 2023 | undertypologi</code>or <code>SN 2020 | undertypologi</code> tab.</li>
</ul>
</li>
</ol>
<figure style="width: 100%; max-width: 650px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="bgf_subtypology.PNG" alt="Fill out the BGF typology." style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Fill out the BGF typology, based on the selected Norm a subtypology can be selected.
</figcaption></figure><ol start="4" type="1">
<li>
<p>Check the calculated BGF value for the polygon.</p>
<p>The BGF value for the selected norm is visible under the tab <code>PBE 2023 | BGF beregning</code> or <code>SN 2023 | BGF beregning</code>.</p>
</li>
</ol>
<div class="note">
<p><strong>Note</strong> that these values are not (yet) divided by the total study area. It is also important to note that all classes are calculated by multiplying the typology area by the weight, except for trees. Here the count of trees is multiplied by the weight. It is important to map trees individually as the tool assumes that each row in the attribute table stands for óne tree. Thus the BGF value for a tree polygon equals the weight (1*BGF weight). The total BGF score is calculated in a separate table see <a href="#total-bgf">Calculate the total BGF score</a>.</p>
</div>
<ol start="5" type="1">
<li>
<p>(OPTIONAL) use a user-defined norm.</p>
<p>After filling in the BGF typology, you see that also a tab appears for <code>Egendefinerte Norm | BGF beregning</code>. The user-defined norm is not filled out as default and thus the BGF weight and value will be set to <code>NULL</code>.</p>
<p><strong>Define your own Norm:</strong></p>
<ul>
<li>Open the lookup table <code>lut_bgf_weight</code> under the tab <code>BGF koblingstabller</code>: <code>Right click -&gt; Open attribute table</code>
</li>
<li>Activate editing mode by clicking on the <code>Pencil</code> icon.</li>
<li>Fill out values for each typlogy under the column <code>custom_weight</code>.</li>
<li>Start mapping your BGF typologies, the user-defined norm will now be automatically calculated using the values you entered in the table.</li>
</ul>
</li>
</ol>
<figure style="width: 100%; max-width: 650px; display: block; margin-left: auto; margin-right: auto;" class="figure"><img src="bgf_custom_norm.PNG" alt="Fill out the BGF typology." style="width: 100%; height: auto;" class="figure-img"><figcaption style="text-align: center;">
Define custom weights.
</figcaption></figure><ol start="6" type="1">
<li>
<p>Check the blue-green infrastructure costs under the group <code>Kostnader</code>.</p>
<p>The costs are calculated automatically, by using a <a href="link/here">lookup_table</a>. Note that costs are calculated by multiplying the area (m2) by the cost value in the look up table. Thus, trees are also economically valued by tree crown coverage and not per individual tree.</p>
</li>
<li><p>Add a comment, or leave the default value: <code>Ingen kommentar</code>.</p></li>
</ol>
<p>Repeat these steps untill the complete study area is mapped and the <code>Kartlagt areal (%)</code> attribute shows 100 %.</p>
<div class="note">
<p><strong>Note:</strong> that the complete study area must be mapped and all attributes must be filled out correctly, otherwise the BGF score cannot be calculated. If a polygon is not mapped correctly, or the attributes are not filled out correctly it will be classified as <code>Ikke klassifisert</code>.</p>
</div>
</section><section id="total-bgf" class="level3"><h3 class="anchored" data-anchor-id="total-bgf">Calculate the total BGF score</h3>
<p>The final BGF score for each study area is calculated in a separate table under the tab <code>BGF beregning</code>. These table aggregates the results of the BGF-mapping and calculates the BGF score. Note that the total score is calculated differently for different norms. It is important to choose the correct norm and follow the steps outlined below.</p>
<section id="norm-pbe-2023" class="level4"><h4 class="anchored" data-anchor-id="norm-pbe-2023">Norm PBE 2023</h4>
<ol type="1">
<li>Navigate to: <code>BGF beregning -&gt; Norm PBE 2023 | BGF beregning</code>
</li>
<li>Open the attribute table: <code>right-click</code>.</li>
<li>Switch to <code>form view</code> in the bottom right corner.</li>
<li>Check that the info under <code>Admin</code>, <code>Areal</code> and <code>BGF norm</code> is filled in correctly.</li>
<li>Answer the TRUE-FALSE questions under <code>Styrke blågrønn struktur og biologisk mangfold</code>.</li>
<li>Check the automatically calculated BGF-values per typology type under <code>Terreng og Flater</code>
</li>
<li>Check the automatically calculated BGF-values for trees under <code>Trær</code>
</li>
<li>Check the total BGF-score</li>
<li>Export results: <code>right-click -&gt; Export -&gt; Save features as -&gt; CSV/EXCEL</code>
</li>
</ol>
<p><em>SN Norm not yet included, wait for license</em></p>
</section></section><section id="calculate-the-total-cost-for-blue-green-infrastructure" class="level3"><h3 class="anchored" data-anchor-id="calculate-the-total-cost-for-blue-green-infrastructure">Calculate the total cost for Blue-Green Infrastructure</h3>
<p><em>work in progress, needs feedback from bart/max</em></p>
</section><section id="export-data" class="level3"><h3 class="anchored" data-anchor-id="export-data">Export Data</h3>
<p>To export your data right-click on the layer you like to export and choose <code>Export -&gt; Save features as</code>. In the upper drop-down box you can choose your export format.</p>
<p>Here are examples for the most common exports:</p>
<ul>
<li>Export blue-green structure typologies to .GPKG: go to layer <code>BGF typologies</code> and <code>Export</code> as GPKG (to include geometry) or to csv/excel to only export the attributes.</li>
<li>Export the final BGF score: <code>BGF beregning -&gt; Norm PBE .. or  Norm SN ..</code> to csv</li>
<li>Export the final blue-green structure costs: <code>BGF beregning -&gt; BGF Cost beregning</code>.</li>
</ul>
<p><strong>Future improvements:</strong></p>
<ul>
<li>option to export a PDF rapport</li>
</ul></section><section id="common-errors" class="level3"><h3 class="anchored" data-anchor-id="common-errors">Common errors</h3>
<ul>
<li>Topology errors, solve using the <code>Topology Checker</code> pluginn read more in the <a href="https://docs.qgis.org/3.34/en/docs/user_manual/plugins/core_plugins/plugins_topology_checker.html">QGIS User Guide</a>
</li>
<li>Attributes are not calculated, sometimes you must make a change before the calculations of attributes take place. Solve by for example changing the typology to another value and then change back.</li>
<li>Attribute values you fill in are overwritten by the default value. For example, the field <code>Kommentar</code> does not want to change. Go to the layer where the problem occurs, right-click on <code>Properties</code> navigate to <code>Attribute forms</code> and uncheck <code>Apply default value by update</code>.</li>
</ul></section></section><section id="nina-contacts" class="level2"><h2 class="anchored" data-anchor-id="nina-contacts">NINA Contacts</h2>
<div class="columns">
<div class="column">
<p><strong>BGF:</strong></p>
<ul>
<li>David Barton</li>
<li>Bart Immerzeel</li>
<li>Maria Korkou</li>
</ul>
</div><div class="column">
<p><strong>BGF-QGIS application:</strong></p>
<ul>
<li>Willeke A’Campo</li>
<li>Bart Immerzeel</li>
</ul>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../data-collection/field-surveys/qfield-bm.html" class="pagination-link" aria-label="Biodiversity Metric 4.0">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Biodiversity Metric 4.0</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../data-collection/field-surveys/rshiny-carbonviewer.html" class="pagination-link" aria-label="CarbonViewer">
        <span class="nav-page-text"><span class="chapter-title">CarbonViewer</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/NINAnor/EAguide/edit/main/data-collection/field-surveys/qfield-bgf.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>